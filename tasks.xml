<?xml version="1.0"?>

<project name="tasks">

    <property file="build.properties"/>
    <property name="version" value="1.0"/>

    <target name="compile" description="Compile Java source.">
        <mkdir dir="${build.dir}/classes"/>
        <javac srcdir="${src.dir}"
               debug="on"
               destdir="${build.dir}/classes">
            <classpath refid="compile.classpath"/>
        </javac>
        <copy toDir="${build.dir}/classes">
            <fileset dir="${src.dir}" excludes="**/*.java"/>
        </copy>
    </target>

    <target name="test.compile"
            depends="compile"
            description="Compile test source.">
        <mkdir dir="${build.dir}/tests"/>
        <javac srcdir="${test.dir}"
               debug="on"
               destdir="${build.dir}/tests">
            <classpath path="${build.dir}/classes"/>
            <classpath refid="compile.classpath"/>
        </javac>
        <copy toDir="${build.dir}/tests">
            <fileset dir="${test.dir}" excludes="**/*.java"/>
        </copy>
    </target>

    <target name="test"
            depends="test.compile"
            description="Execute JUnit tests.">
        <java fork="true"
              classname="org.junit.runner.JUnitCore"
              failonerror="true">
            <classpath>
                <pathelement location="${build.dir}/tests"/>
                <pathelement location="${build.dir}/classes"/>
                <pathelement location="${lib.dir}/*.jar" />
                <path refid="compile.classpath"/>
            </classpath>
            <arg value="${test.class}"/>
        </java>
    </target>

    <target name="clean"
            description="Remove generated files.">
        <delete dir="${build.dir}"/>
    </target>

</project>
